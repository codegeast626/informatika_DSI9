<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Waspada Malware di Dunia Digital</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .animate-fadeIn {
      animation: fadeIn 0.5s ease-out;
    }
    
    .animate-bounce-once {
      animation: bounce 0.6s ease-in-out;
    }
    
    .animate-shake {
      animation: shake 0.5s ease-in-out;
    }
    
    .animate-pulse-slow {
      animation: pulse 2s ease-in-out infinite;
    }
    
    .dragging {
      opacity: 0.5;
      transform: rotate(5deg);
    }
    
    .drop-zone-active {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
    }
    
    .card-success {
      animation: bounce 0.6s ease-in-out;
    }
    
    .card-error {
      animation: shake 0.5s ease-in-out;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-auto" style="background-color: #0f172a; color: #f1f5f9; font-family: system-ui, -apple-system, sans-serif;">
  <div id="app" class="w-full h-full"></div>
  <script>
    // Audio Context untuk sound effects
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    // Fungsi untuk membuat sound effects
    function playSound(type) {
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      
      const now = audioCtx.currentTime;
      
      switch(type) {
        case 'correct':
          // Sound sukses - nada naik
          oscillator.frequency.setValueAtTime(523.25, now); // C5
          oscillator.frequency.setValueAtTime(659.25, now + 0.1); // E5
          oscillator.frequency.setValueAtTime(783.99, now + 0.2); // G5
          gainNode.gain.setValueAtTime(0.3, now);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
          oscillator.start(now);
          oscillator.stop(now + 0.3);
          break;
          
        case 'wrong':
          // Sound error - nada turun
          oscillator.frequency.setValueAtTime(392, now); // G4
          oscillator.frequency.setValueAtTime(293.66, now + 0.15); // D4
          gainNode.gain.setValueAtTime(0.3, now);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.25);
          oscillator.start(now);
          oscillator.stop(now + 0.25);
          break;
          
        case 'click':
          // Sound klik button
          oscillator.frequency.setValueAtTime(800, now);
          gainNode.gain.setValueAtTime(0.1, now);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
          oscillator.start(now);
          oscillator.stop(now + 0.1);
          break;
          
        case 'complete':
          // Sound level complete - melodi kemenangan
          const notes = [523.25, 587.33, 659.25, 783.99, 880];
          notes.forEach((freq, index) => {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.setValueAtTime(freq, now + index * 0.1);
            gain.gain.setValueAtTime(0.2, now + index * 0.1);
            gain.gain.exponentialRampToValueAtTime(0.01, now + index * 0.1 + 0.2);
            osc.start(now + index * 0.1);
            osc.stop(now + index * 0.1 + 0.2);
          });
          break;
          
        case 'drag':
          // Sound pickup
          oscillator.frequency.setValueAtTime(400, now);
          oscillator.frequency.exponentialRampToValueAtTime(600, now + 0.05);
          gainNode.gain.setValueAtTime(0.1, now);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
          oscillator.start(now);
          oscillator.stop(now + 0.05);
          break;
      }
    }

    const config = {
      app_title: "Waspada Malware di Dunia Digital",
      welcome_text: "Mari belajar mengenali jenis-jenis malware!",
      instruction_text: "Seret kartu malware ke kategori yang tepat",
      background_color: "#0f172a",
      surface_color: "#1e293b",
      text_color: "#f1f5f9",
      primary_color: "#3b82f6",
      secondary_color: "#10b981",
      font_size: 16
    };

    const malwareData = {
      virus: {
        name: "Virus",
        icon: "ü¶†",
        color: "#ef4444",
        description: "",
        levels: [
          // Level 1 - Mudah
          [
            {
              id: "v1",
              title: "Menempel pada <i>File</i>",
              description: "Menginfeksi <i>file</i> .exe dan menyebar saat <i>file</i> dibuka."
            },
            {
              id: "v2",
              title: "Butuh <i>Host</i>",
              description: "Tidak dapat bekerja sendiri, perlu program lain."
            }
          ],
          // Level 2 - Sedang
          [
            {
              id: "v3",
              title: "<i>Boot Sector Virus</i>",
              description: "Menginfeksi bagian <i>boot</i> komputer saat dinyalakan."
            },
            {
              id: "v4",
              title: "Merusak Data",
              description: "Dapat menghapus atau mengubah <i>file</i> penting."
            }
          ],
          // Level 3 - Sulit
          [
            {
              id: "v5",
              title: "<i>Polymorphic Virus</i>",
              description: "Mengubah kode dirinya sendiri untuk mengelabui antivirus."
            },
            {
              id: "v6",
              title: "Replikasi Terkontrol",
              description: "Menyalin dirinya ke <i>file</i> lain secara otomatis."
            }
          ]
        ]
      },
      worm: {
        name: "Worm",
        icon: "üêõ",
        color: "#f59e0b",
        description: "",
        levels: [
          // Level 1
          [
            {
              id: "w1",
              title: "Mandiri",
              description: "Dapat bekerja dan menyebar sendiri tanpa <i>file host</i>."
            },
            {
              id: "w2",
              title: "Menyebar via Jaringan",
              description: "Menggunakan <i>email</i> dan internet untuk menyebar cepat."
            }
          ],
          // Level 2
          [
            {
              id: "w3",
              title: "Menghabiskan <i>Bandwidth</i>",
              description: "Memperlambat jaringan karena replikasi massal."
            },
            {
              id: "w4",
              title: "Eksploitasi Kerentanan",
              description: "Memanfaatkan celah keamanan sistem operasi."
            }
          ],
          // Level 3
          [
            {
              id: "w5",
              title: "Serangan DDoS",
              description: "Membanjiri server target hingga tidak dapat diakses."
            },
            {
              id: "w6",
              title: "Penyebaran Cepat",
              description: "Dapat menginfeksi ribuan komputer dalam hitungan jam."
            }
          ]
        ]
      },
      trojan: {
        name: "Trojan",
        icon: "üê¥",
        color: "#8b5cf6",
        description: "",
        levels: [
          // Level 1
          [
            {
              id: "t1",
              title: "Menyamar",
              description: "Terlihat seperti <i>software</i> berguna atau <i>game</i> menarik."
            },
            {
              id: "t2",
              title: "Pintu Belakang",
              description: "Membuka akses rahasia bagi peretas ke komputer."
            }
          ],
          // Level 2
          [
            {
              id: "t3",
              title: "Tidak Menyebar Sendiri",
              description: "Bergantung pada pengguna untuk menginstalnya."
            },
            {
              id: "t4",
              title: "Kontrol Jarak Jauh",
              description: "Memungkinkan hacker mengendalikan komputer korban."
            }
          ],
          // Level 3
          [
            {
              id: "t5",
              title: "<i>Banking Trojan</i>",
              description: "Mencuri informasi perbankan dan transaksi online."
            },
            {
              id: "t6",
              title: "Menonaktifkan Keamanan",
              description: "Mematikan antivirus dan <i>firewall</i> secara diam-diam."
            }
          ]
        ]
      },
      spyware: {
        name: "Spyware",
        icon: "üïµÔ∏è",
        color: "#ec4899",
        description: "",
        levels: [
          // Level 1
          [
            {
              id: "s1",
              title: "Memantau Aktivitas",
              description: "Merekam ketikan <i>keyboard</i> dan riwayat <i>browsing</i>."
            },
            {
              id: "s2",
              title: "Mencuri Data",
              description: "Mengambil <i>password</i>, nomor kartu kredit, dan info pribadi."
            }
          ],
          // Level 2
          [
            {
              id: "s3",
              title: "Tersembunyi",
              description: "Bekerja diam-diam tanpa diketahui pengguna."
            },
            {
              id: "s4",
              title: "<i>Keylogger</i>",
              description: "Merekam semua yang diketik di <i>keyboard</i>."
            }
          ],
          // Level 3
          [
            {
              id: "s5",
              title: "Tangkapan Layar",
              description: "Mengambil foto layar tanpa sepengetahuan pengguna."
            },
            {
              id: "s6",
              title: "Pelacakan Lokasi",
              description: "Memantau lokasi geografis perangkat korban."
            }
          ]
        ]
      }
    };

    let currentScreen = "welcome";
    let allCards = [];
    let draggedCard = null;
    let correctAnswers = 0;
    let totalCards = 0;
    let answeredCards = new Set();
    let currentLevel = 1;
    let totalLevels = 3;

    function initializeCards() {
      allCards = [];
      Object.keys(malwareData).forEach(category => {
        const levelIndex = currentLevel - 1;
        malwareData[category].levels[levelIndex].forEach(card => {
          allCards.push({
            ...card,
            correctCategory: category,
            currentCategory: null
          });
        });
      });
      totalCards = allCards.length;
      allCards.sort(() => Math.random() - 0.5);
    }

    function render() {
      const app = document.getElementById("app");
      
      if (currentScreen === "welcome") {
        app.innerHTML = renderWelcomeScreen();
      } else if (currentScreen === "instructions") {
        app.innerHTML = renderInstructionsScreen();
      } else if (currentScreen === "game") {
        app.innerHTML = renderGameScreen();
      } else if (currentScreen === "levelComplete") {
        app.innerHTML = renderLevelCompleteScreen();
      } else if (currentScreen === "results") {
        app.innerHTML = renderResultsScreen();
      }
      
      attachEventListeners();
    }

    function renderWelcomeScreen() {
      return `
        <div class="w-full h-full flex items-center justify-center p-8" style="background: linear-gradient(135deg, ${config.background_color} 0%, #1e3a8a 100%);">
          <div class="text-center animate-fadeIn max-w-4xl">
            <div class="mb-8 animate-pulse-slow">
              <span style="font-size: ${config.font_size * 4}px;">üõ°Ô∏è</span>
            </div>
            <h1 class="mb-6" style="font-size: ${config.font_size * 2.5}px; font-weight: 700; line-height: 1.2;">
              ${config.app_title}
            </h1>
            <p class="mb-8 opacity-90" style="font-size: ${config.font_size * 1.25}px;">
              ${config.welcome_text}
            </p>
            <div class="mb-8 flex justify-center gap-4 flex-wrap">
              <div class="px-6 py-3 rounded-lg" style="background-color: ${config.surface_color};">
                <div style="font-size: ${config.font_size * 2}px;">ü¶†</div>
                <div style="font-size: ${config.font_size * 0.875}px;">Virus</div>
              </div>
              <div class="px-6 py-3 rounded-lg" style="background-color: ${config.surface_color};">
                <div style="font-size: ${config.font_size * 2}px;">üêõ</div>
                <div style="font-size: ${config.font_size * 0.875}px;">Worm</div>
              </div>
              <div class="px-6 py-3 rounded-lg" style="background-color: ${config.surface_color};">
                <div style="font-size: ${config.font_size * 2}px;">üê¥</div>
                <div style="font-size: ${config.font_size * 0.875}px;">Trojan</div>
              </div>
              <div class="px-6 py-3 rounded-lg" style="background-color: ${config.surface_color};">
                <div style="font-size: ${config.font_size * 2}px;">üïµÔ∏è</div>
                <div style="font-size: ${config.font_size * 0.875}px;">Spyware</div>
              </div>
            </div>
            <button id="start-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
              style="font-size: ${config.font_size * 1.125}px; background-color: ${config.primary_color}; color: white;">
              Mulai Belajar
            </button>
          </div>
        </div>
      `;
    }

    function renderInstructionsScreen() {
      return `
        <div class="w-full h-full flex items-center justify-center p-8" style="background: linear-gradient(135deg, ${config.background_color} 0%, #1e3a8a 100%);">
          <div class="max-w-4xl animate-fadeIn rounded-3xl p-8" style="background-color: ${config.surface_color};">
            <div class="text-center mb-8">
              <h2 class="mb-4" style="font-size: ${config.font_size * 2}px; font-weight: 700;">
                Cara Bermain
              </h2>
              <p style="font-size: ${config.font_size * 1.125}px; opacity: 0.9;">
                ${config.instruction_text}
              </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
              <div class="p-6 rounded-xl" style="background-color: ${config.background_color};">
                <div class="mb-3" style="font-size: ${config.font_size * 2}px;">üëÜ</div>
                <h3 class="mb-2 font-bold" style="font-size: ${config.font_size * 1.125}px;">
                  Langkah 1: Seret Kartu
                </h3>
                <p style="font-size: ${config.font_size}px; opacity: 0.9;">
                  Klik dan tahan kartu <i>malware</i>, lalu seret ke kategori yang sesuai.
                </p>
              </div>
              
              <div class="p-6 rounded-xl" style="background-color: ${config.background_color};">
                <div class="mb-3" style="font-size: ${config.font_size * 2}px;">üéØ</div>
                <h3 class="mb-2 font-bold" style="font-size: ${config.font_size * 1.125}px;">
                  Langkah 2: Letakkan di Zona
                </h3>
                <p style="font-size: ${config.font_size}px; opacity: 0.9;">
                  Lepaskan kartu di area kategori <i>malware</i> yang tepat.
                </p>
              </div>
              
              <div class="p-6 rounded-xl" style="background-color: ${config.background_color};">
                <div class="mb-3" style="font-size: ${config.font_size * 2}px;">‚úÖ</div>
                <h3 class="mb-2 font-bold" style="font-size: ${config.font_size * 1.125}px;">
                  Jawaban Benar
                </h3>
                <p style="font-size: ${config.font_size}px; opacity: 0.9;">
                  Kartu akan berubah hijau dan kamu dapat penjelasan.
                </p>
              </div>
              
              <div class="p-6 rounded-xl" style="background-color: ${config.background_color};">
                <div class="mb-3" style="font-size: ${config.font_size * 2}px;">‚ùå</div>
                <h3 class="mb-2 font-bold" style="font-size: ${config.font_size * 1.125}px;">
                  Jawaban Salah
                </h3>
                <p style="font-size: ${config.font_size}px; opacity: 0.9;">
                  Kartu kembali ke tempat awal, coba lagi!
                </p>
              </div>
            </div>
            
            <div class="text-center">
              <button id="play-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
                style="font-size: ${config.font_size * 1.125}px; background-color: ${config.primary_color}; color: white;">
                Mulai Kuis
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function renderGameScreen() {
      const availableCards = allCards.filter(card => !answeredCards.has(card.id));
      const progress = (correctAnswers / totalCards) * 100;
      
      return `
        <div class="w-full h-full p-6" style="background-color: ${config.background_color};">
          <div class="max-w-7xl mx-auto h-full flex flex-col">
            <!-- Header dengan Peta Level -->
            <div class="mb-4">
              <div class="flex justify-between items-center mb-3">
                <div>
                  <h2 class="font-bold" style="font-size: ${config.font_size * 1.25}px;">
                    Waspada <i>Malware</i> - Level ${currentLevel}
                  </h2>
                  <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.8;">
                    Cocokkan setiap kartu dengan kategori yang tepat.
                  </p>
                </div>
                <div class="text-right">
                  <div class="font-bold" style="font-size: ${config.font_size * 1.125}px; color: ${config.primary_color};">
                    ${correctAnswers} / ${totalCards}
                  </div>
                  <div style="font-size: ${config.font_size * 0.75}px; opacity: 0.8;">
                    Jawaban Benar
                  </div>
                </div>
              </div>
              
              <!-- Peta Perjalanan Level -->
              <div class="relative p-4 rounded-xl" style="background: linear-gradient(135deg, ${config.surface_color} 0%, ${config.background_color} 100%);">
                <div class="flex justify-between items-center relative">
                  <!-- Garis Penghubung -->
                  <div class="absolute top-1/2 left-0 right-0 h-1 transform -translate-y-1/2" 
                    style="background: linear-gradient(to right, ${config.primary_color} 0%, ${config.primary_color} ${(currentLevel - 1) / (totalLevels - 1) * 100}%, rgba(255,255,255,0.2) ${(currentLevel - 1) / (totalLevels - 1) * 100}%, rgba(255,255,255,0.2) 100%);">
                  </div>
                  
                  ${Array.from({length: totalLevels}, (_, i) => {
                    const level = i + 1;
                    const isCompleted = level < currentLevel;
                    const isCurrent = level === currentLevel;
                    const isLocked = level > currentLevel;
                    
                    return `
                      <div class="relative z-10 flex flex-col items-center ${isCurrent ? 'animate-pulse-slow' : ''}">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center mb-1 border-3 transition-all duration-300"
                          style="background-color: ${isCompleted ? config.secondary_color : isCurrent ? config.primary_color : config.surface_color}; 
                                 border: 3px solid ${isCompleted || isCurrent ? config.primary_color : 'rgba(255,255,255,0.3)'};">
                          <span style="font-size: ${config.font_size * 1.125}px;">
                            ${isCompleted ? '‚úì' : isLocked ? 'üîí' : level}
                          </span>
                        </div>
                        <div class="font-bold" style="font-size: ${config.font_size * 0.75}px; opacity: ${isCurrent ? 1 : 0.7};">
                          Level ${level}
                        </div>
                        <div style="font-size: ${config.font_size * 0.625}px; opacity: 0.6;">
                          ${level === 1 ? 'Mudah' : level === 2 ? 'Sedang' : 'Sulit'}
                        </div>
                      </div>
                    `;
                  }).join('')}
                </div>
                
                <!-- Progress Bar -->
                <div class="mt-3">
                  <div class="flex justify-between mb-1">
                    <span style="font-size: ${config.font_size * 0.75}px; opacity: 0.8;">Progress Level ${currentLevel}</span>
                    <span style="font-size: ${config.font_size * 0.75}px; font-weight: bold; color: ${config.primary_color};">${Math.round(progress)}%</span>
                  </div>
                  <div class="w-full h-2 rounded-full overflow-hidden" style="background-color: ${config.background_color};">
                    <div class="h-full transition-all duration-500 rounded-full" 
                      style="width: ${progress}%; background: linear-gradient(to right, ${config.primary_color}, ${config.secondary_color});">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Drop Zones -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4">
              ${Object.keys(malwareData).map(category => {
                const data = malwareData[category];
                const categoryCards = allCards.filter(c => c.currentCategory === category);
                return `
                  <div class="drop-zone rounded-xl p-3 transition-all duration-300 min-h-[150px]"
                    data-category="${category}"
                    style="background-color: ${config.surface_color}; border: 2px dashed ${data.color};">
                    <div class="text-center mb-2">
                      <div style="font-size: ${config.font_size * 1.5}px;">${data.icon}</div>
                      <h3 class="font-bold" style="font-size: ${config.font_size}px; color: ${data.color};">
                        ${data.name}
                      </h3>
                    </div>
                    <div class="space-y-2">
                      ${categoryCards.map(card => `
                        <div class="p-2 rounded-lg" style="background-color: ${config.secondary_color}; opacity: 0.9;">
                          <div class="font-bold" style="font-size: ${config.font_size * 0.75}px;">
                            ‚úì ${card.title}
                          </div>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
            
            <!-- Available Cards -->
            <div class="flex-1 overflow-auto pb-4">
              <h3 class="font-bold mb-3" style="font-size: ${config.font_size}px;">
                Kartu <i>Malware</i> (${availableCards.length} tersisa)
              </h3>
              <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 pb-4">
                ${availableCards.map(card => `
                  <div class="malware-card cursor-move rounded-xl p-3 transition-all duration-300 hover:scale-105"
                    draggable="true"
                    data-card-id="${card.id}"
                    style="background-color: ${config.surface_color}; border: 2px solid ${config.primary_color};">
                    <h4 class="font-bold mb-2" style="font-size: ${config.font_size * 0.875}px;">
                      ${card.title}
                    </h4>
                    <p style="font-size: ${config.font_size * 0.75}px; opacity: 0.9;">
                      ${card.description}
                    </p>
                  </div>
                `).join('')}
              </div>
            </div>
            
            <!-- Feedback Area -->
            <div id="feedback-area" class="rounded-xl p-3 text-center transition-all duration-300" 
              style="min-height: 60px; background-color: ${config.surface_color}; display: none;">
            </div>
          </div>
        </div>
      `;
    }

    function renderLevelCompleteScreen() {
      const hasNextLevel = currentLevel < totalLevels;
      
      return `
        <div class="w-full h-full flex items-center justify-center p-8" style="background: linear-gradient(135deg, ${config.background_color} 0%, #1e3a8a 100%);">
          <div class="max-w-4xl animate-fadeIn rounded-3xl p-8 text-center" style="background-color: ${config.surface_color};">
            <div class="mb-6 animate-bounce-once">
              <span style="font-size: ${config.font_size * 5}px;">üéâ</span>
            </div>
            
            <h2 class="mb-4 font-bold" style="font-size: ${config.font_size * 2}px;">
              Level ${currentLevel} Selesai!
            </h2>
            
            <p class="mb-6" style="font-size: ${config.font_size * 1.125}px; opacity: 0.9;">
              Sempurna! Kamu berhasil menyelesaikan semua tantangan di level ini.
            </p>
            
            <div class="mb-8 p-6 rounded-2xl" style="background-color: ${config.background_color};">
              <div class="mb-2" style="font-size: ${config.font_size * 3}px; font-weight: 700; color: ${config.secondary_color};">
                100%
              </div>
              <div style="font-size: ${config.font_size * 1.125}px;">
                ${totalCards} dari ${totalCards} jawaban benar
              </div>
            </div>
            
            ${hasNextLevel ? `
              <div class="mb-6 p-6 rounded-2xl" style="background-color: ${config.background_color};">
                <div class="mb-3" style="font-size: ${config.font_size * 2}px;">üîì</div>
                <h3 class="font-bold mb-2" style="font-size: ${config.font_size * 1.25}px;">
                  Level Selanjutnya Terbuka!
                </h3>
                <p style="font-size: ${config.font_size}px; opacity: 0.9;">
                  Bersiaplah untuk tantangan yang lebih sulit dengan kasus <i>malware</i> yang lebih kompleks.
                </p>
              </div>
              
              <div class="flex gap-4 justify-center">
                <button id="next-level-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
                  style="font-size: ${config.font_size * 1.125}px; background-color: ${config.primary_color}; color: white;">
                  Lanjut ke Level ${currentLevel + 1}
                </button>
                <button id="restart-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
                  style="font-size: ${config.font_size * 1.125}px; background-color: ${config.surface_color}; color: ${config.text_color}; border: 2px solid ${config.primary_color};">
                  Ulang Level Ini
                </button>
              </div>
            ` : `
              <button id="view-final-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
                style="font-size: ${config.font_size * 1.125}px; background-color: ${config.primary_color}; color: white;">
                Lihat Hasil Akhir
              </button>
            `}
          </div>
        </div>
      `;
    }

    function renderResultsScreen() {
      return `
        <div class="w-full h-full flex items-center justify-center p-8" style="background: linear-gradient(135deg, ${config.background_color} 0%, #1e3a8a 100%);">
          <div class="max-w-4xl animate-fadeIn rounded-3xl p-8 text-center" style="background-color: ${config.surface_color};">
            <div class="mb-6 animate-bounce-once">
              <span style="font-size: ${config.font_size * 5}px;">üèÜ</span>
            </div>
            
            <h2 class="mb-4 font-bold" style="font-size: ${config.font_size * 2}px;">
              Selamat! Semua Level Selesai!
            </h2>
            
            <p class="mb-6" style="font-size: ${config.font_size * 1.125}px; opacity: 0.9;">
              Luar biasa! Kamu telah menguasai semua jenis <i>malware</i> dan karakteristiknya.
            </p>
            
            <div class="mb-8 p-6 rounded-2xl" style="background-color: ${config.background_color};">
              <div class="mb-2" style="font-size: ${config.font_size * 3}px; font-weight: 700; color: ${config.primary_color};">
                100%
              </div>
              <div style="font-size: ${config.font_size * 1.125}px;">
                Menyelesaikan ${totalLevels} level dengan sempurna
              </div>
            </div>
            
            <div class="mb-8 text-left space-y-4">
              <h3 class="font-bold mb-4 text-center" style="font-size: ${config.font_size * 1.25}px;">
                Poin Penting Keamanan Digital:
              </h3>
              
              <div class="p-4 rounded-xl" style="background-color: ${config.background_color};">
                <div class="flex items-start gap-3">
                  <span style="font-size: ${config.font_size * 1.5}px;">üõ°Ô∏è</span>
                  <div>
                    <div class="font-bold mb-1" style="font-size: ${config.font_size * 1.125}px;">
                      Pasang <i>Antivirus</i>
                    </div>
                    <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.9;">
                      Gunakan <i>antivirus</i> terpercaya dan selalu <i>update</i> definisi virus.
                    </p>
                  </div>
                </div>
              </div>
              
              <div class="p-4 rounded-xl" style="background-color: ${config.background_color};">
                <div class="flex items-start gap-3">
                  <span style="font-size: ${config.font_size * 1.5}px;">‚ö†Ô∏è</span>
                  <div>
                    <div class="font-bold mb-1" style="font-size: ${config.font_size * 1.125}px;">
                      Waspada <i>Link</i> & Lampiran
                    </div>
                    <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.9;">
                      Jangan sembarangan klik <i>link</i> atau buka lampiran dari pengirim tidak dikenal.
                    </p>
                  </div>
                </div>
              </div>
              
              <div class="p-4 rounded-xl" style="background-color: ${config.background_color};">
                <div class="flex items-start gap-3">
                  <span style="font-size: ${config.font_size * 1.5}px;">üîÑ</span>
                  <div>
                    <div class="font-bold mb-1" style="font-size: ${config.font_size * 1.125}px;">
                      <i>Update</i> Sistem Operasi
                    </div>
                    <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.9;">
                      Selalu perbarui sistem operasi untuk menambal celah keamanan.
                    </p>
                  </div>
                </div>
              </div>
              
              <div class="p-4 rounded-xl" style="background-color: ${config.background_color};">
                <div class="flex items-start gap-3">
                  <span style="font-size: ${config.font_size * 1.5}px;">üíæ</span>
                  <div>
                    <div class="font-bold mb-1" style="font-size: ${config.font_size * 1.125}px;">
                      <i>Backup</i> Data Rutin
                    </div>
                    <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.9;">
                      Simpan salinan data penting di tempat terpisah sebagai antisipasi.
                    </p>
                  </div>
                </div>
              </div>
              
              <div class="p-4 rounded-xl" style="background-color: ${config.background_color};">
                <div class="flex items-start gap-3">
                  <span style="font-size: ${config.font_size * 1.5}px;">üîê</span>
                  <div>
                    <div class="font-bold mb-1" style="font-size: ${config.font_size * 1.125}px;">
                      <i>Password</i> Kuat
                    </div>
                    <p style="font-size: ${config.font_size * 0.875}px; opacity: 0.9;">
                      Gunakan <i>password</i> yang unik dan kompleks untuk setiap akun.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="flex gap-4 justify-center">
              <button id="restart-all-btn" class="px-12 py-4 rounded-full font-bold transition-all duration-300 hover:scale-110" 
                style="font-size: ${config.font_size * 1.125}px; background-color: ${config.primary_color}; color: white;">
                Permainan Baru
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function attachEventListeners() {
      const startBtn = document.getElementById("start-btn");
      if (startBtn) {
        startBtn.addEventListener("click", () => {
          playSound('click');
          currentScreen = "instructions";
          render();
        });
      }
      
      const playBtn = document.getElementById("play-btn");
      if (playBtn) {
        playBtn.addEventListener("click", () => {
          playSound('click');
          currentScreen = "game";
          currentLevel = 1;
          initializeCards();
          correctAnswers = 0;
          answeredCards.clear();
          render();
        });
      }
      
      const nextLevelBtn = document.getElementById("next-level-btn");
      if (nextLevelBtn) {
        nextLevelBtn.addEventListener("click", () => {
          playSound('click');
          currentLevel++;
          currentScreen = "game";
          initializeCards();
          correctAnswers = 0;
          answeredCards.clear();
          render();
        });
      }
      
      const restartBtn = document.getElementById("restart-btn");
      if (restartBtn) {
        restartBtn.addEventListener("click", () => {
          playSound('click');
          currentScreen = "game";
          initializeCards();
          correctAnswers = 0;
          answeredCards.clear();
          render();
        });
      }
      
      const viewFinalBtn = document.getElementById("view-final-btn");
      if (viewFinalBtn) {
        viewFinalBtn.addEventListener("click", () => {
          playSound('click');
          currentScreen = "results";
          render();
        });
      }
      
      const restartAllBtn = document.getElementById("restart-all-btn");
      if (restartAllBtn) {
        restartAllBtn.addEventListener("click", () => {
          playSound('click');
          currentScreen = "welcome";
          currentLevel = 1;
          correctAnswers = 0;
          answeredCards.clear();
          render();
        });
      }
      
      // Drag and Drop
      const cards = document.querySelectorAll(".malware-card");
      const dropZones = document.querySelectorAll(".drop-zone");
      
      cards.forEach(card => {
        card.addEventListener("dragstart", handleDragStart);
        card.addEventListener("dragend", handleDragEnd);
      });
      
      dropZones.forEach(zone => {
        zone.addEventListener("dragover", handleDragOver);
        zone.addEventListener("dragenter", handleDragEnter);
        zone.addEventListener("dragleave", handleDragLeave);
        zone.addEventListener("drop", handleDrop);
      });
    }

    function handleDragStart(e) {
      const cardId = e.target.dataset.cardId;
      draggedCard = allCards.find(c => c.id === cardId);
      e.target.classList.add("dragging");
      playSound('drag');
    }

    function handleDragEnd(e) {
      e.target.classList.remove("dragging");
    }

    function handleDragOver(e) {
      e.preventDefault();
    }

    function handleDragEnter(e) {
      if (e.target.classList.contains("drop-zone")) {
        e.target.classList.add("drop-zone-active");
      }
    }

    function handleDragLeave(e) {
      if (e.target.classList.contains("drop-zone")) {
        e.target.classList.remove("drop-zone-active");
      }
    }

    function handleDrop(e) {
      e.preventDefault();
      const zone = e.target.closest(".drop-zone");
      if (!zone || !draggedCard) return;
      
      zone.classList.remove("drop-zone-active");
      const category = zone.dataset.category;
      
      checkAnswer(draggedCard, category);
    }

    function checkAnswer(card, selectedCategory) {
      const feedbackArea = document.getElementById("feedback-area");
      const isCorrect = card.correctCategory === selectedCategory;
      
      if (isCorrect) {
        playSound('correct');
        correctAnswers++;
        answeredCards.add(card.id);
        card.currentCategory = selectedCategory;
        
        feedbackArea.style.display = "block";
        feedbackArea.style.backgroundColor = config.secondary_color;
        feedbackArea.innerHTML = `
          <div class="animate-bounce-once">
            <div style="font-size: ${config.font_size * 2}px;">‚úÖ</div>
            <div class="font-bold mt-2" style="font-size: ${config.font_size * 1.125}px;">
              Benar!
            </div>
            <p style="font-size: ${config.font_size}px; opacity: 0.9;">
              ${card.title} memang termasuk ${malwareData[selectedCategory].name}.
            </p>
          </div>
        `;
        
        setTimeout(() => {
          if (answeredCards.size === totalCards) {
            playSound('complete');
            // Level selesai
            if (currentLevel < totalLevels) {
              currentScreen = "levelComplete";
            } else {
              currentScreen = "results";
            }
            render();
          } else {
            render();
          }
        }, 1500);
      } else {
        playSound('wrong');
        feedbackArea.style.display = "block";
        feedbackArea.style.backgroundColor = "#ef4444";
        feedbackArea.innerHTML = `
          <div class="animate-shake">
            <div style="font-size: ${config.font_size * 2}px;">‚ùå</div>
            <div class="font-bold mt-2" style="font-size: ${config.font_size * 1.125}px;">
              Coba Lagi!
            </div>
            <p style="font-size: ${config.font_size}px; opacity: 0.9;">
              ${card.title} bukan termasuk ${malwareData[selectedCategory].name}.
            </p>
          </div>
        `;
        
        setTimeout(() => {
          feedbackArea.style.display = "none";
        }, 2000);
      }
    }

    render();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b7eac62f116e9d5',t:'MTc2NzQwMzIyMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
